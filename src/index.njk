---
pagination:
  data: updates
  size: 5
  alias: latest_updates
---
{% extends 'layouts/bare.njk' %}

{% set title = "DefiPlaza: The low-cost exchange on Ethereum" %}
{% set description = "ðŸ‘‰ 65% cheaper than Uniswap to swap tokens. ðŸ‘‰ Earn a 250% staking APR while passively investing in a basket of 16 ERC-20 tokens!" %}

{%- block preload -%}
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js" as="script" crossorigin>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/ScrollTrigger.min.js" as="script" crossorigin>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bignumber.js/8.0.2/bignumber.min.js" as="script" crossorigin>
{%- endblock -%}

{% block bare %}
	{% include "partials/header.njk" %}

	<script>
	function check_webp_feature(feature, callback) {
		var kTestImages = {
			lossy: "UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",
			lossless: "UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",
			alpha: "UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",
			animation: "UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"
		};
		var img = new Image();
		img.onload = function () {
			var result = (img.width > 0) && (img.height > 0);
			callback(feature, result);
		};
		img.onerror = function () {
			callback(feature, false);
		};
		img.src = "data:image/webp;base64," + kTestImages[feature];
	}

	check_webp_feature('lossy', (feature, result) => {
		var webPClass = (result ? 'webp' : 'no-webp');
		document.getElementsByTagName("body")[0].classList.add(webPClass);	
	});
	</script>

	<div class="relative -mt-[71px] pt-[71px] bg-background-500 dark:bg-primary-600">
		<div id="heroSection">
			{# Sequence #}
			<div class="fixed top-0 md:top-[10vh] right-0 md:right-4 hero-preload bg-center-top bg-no-repeat bg-static h-[120vh] md:h-[120vh] z-0" id="heroSequence">&nbsp;</div>

			{# Hero #}
			<section class="relative h-[90vh] md:h-[65vh] mx-auto px-4 md:px-0 pb-20 md:pb-0 flex flex-col justify-center items-center z-10 bg-background-500/75 dark:bg-primary-600/70 md:bg-transparent md:bg-gradient-to-b md:from-background-500/75 dark:md:from-primary-600/75">
				<h1 class="fluid-80 text-center dark:text-white">The <span class="italic font-serif">best deal</span> for swapping<br class="hidden md:block"> tokens on Ethereum</h1>
				<div class="flex flex-row flex-wrap md:flex-nowrap justify-center space-x-4 mt-12 sm:mt-16 md:mt-8">
					<a href="https://app.defiplaza.net/swap" id="launch-app-home-button" class="btn-primary inline-flex items-center mt-4 sm:mt-0">
						<span class="mt-px whitespace-nowrap">Start swapping tokens</span>
						<span class="hidden sm:inline-block">{% include "partials/arrow-right.njk" %}</span>
					</a>

					<div class="flex justify-center items-center w-full md:w-min mt-8 md:mt-0 md:ml-8 space-x-4">
						<p class="text-primary-500 hover:text-primary-300 dark:text-white dark:hover:text-primary-100"><a href="https://t.me/defiplaza" target="_blank">{% include 'svg/socials/telegram.svg' %}</a></p>
						<p class="text-primary-500 hover:text-primary-300 dark:text-white dark:hover:text-primary-100"><a href="https://twitter.com/defiplaza" target="_blank">{% include 'svg/socials/twitter.svg' %}</a></p>
						{# <p class="text-primary-500 hover:text-primary-300 dark:text-white dark:hover:text-primary-100"><a href="https://github.com/OmegaSyndicate" target="_blank">{% include 'svg/socials/github.svg' %}</a></p> #}
						<p class="text-primary-500 hover:text-primary-300 dark:text-white dark:hover:text-primary-100"><a href="https://defiplaza.net/discord" target="_blank">{% include 'svg/socials/discord.svg' %}</a></p>

					</div>
				</div>
			</section>

			{# What is DefiPlaza #}
			<section class="relative xl:container xl:mx-auto flex flex-col-reverse md:flex-row">
				<div class="md:w-1/2 z-10 bg-white dark:bg-primary-800 md:rounded-tr-3xl md:rounded-br-3xl pt-11 pb-24 md:pt-24 px-4 md:px-20  overflow-hidden">
					<h2 class="fluid-40 dark:text-primary-100">
						<strong class="font-bold text-primary-500 dark:text-white">DefiPlaza</strong> lets you swap with up to 65% lower fees than UniSwap</h2>
					<p class="mt-4">Like other exchanges, DefiPlaza offers trades between tokens by functioning as an Automated Market Maker (AMM).</p>
					<p class="mt-4">What makes DefiPlaza special are  <i>single-contract</i>, <i>highly optimized DEXs</i>, designed to offer the lowest possible trade cost to the end user. 
						Gas costs per trade are the lowest in the industry, and thanks to the multi-token set up very capital efficient, while Impermanent Loss is minimized.</p>
					<p class="mt-4">We currently have <strong>two multi-token pools</strong>, focussed on blue chip tokens and stable tokens. For each trade we automatically select the pool that would result in the lowest trade fee.</p>
				</div>

				{# Stats #}
				<div class="relative w-full md:w-1/2 z-10">
					<ul class="absolute z-10 bottom-0 md:top-24 md:right-0 w-full md:w-fit max-h-min p-4 md:px-8 grid grid-cols-4 md:grid-cols-2 lg:grid-cols-4 gap-8 bg-primary-500 dark:bg-primary-800 text-white md:rounded-lg text-center" id="stats">
						<li>
							<p class="text-2xl md:text-3xl font-bold whitespace-nowrap">
								<span id="tvl" class="text-primary-500">{% include "partials/loading-indicator.njk" %}</span>
								<span id="tvlSuffix" class="text-base font-light align-middle">&nbsp;</span>
							</p>
							<h3 class="text-sm whitespace-nowrap dark:text-primary-100">Liquidity</h3>
						</li>
						<li>
							<p class="text-2xl md:text-3xl font-bold whitespace-nowrap">
								<span id="totalVolume" class="text-primary-500">{% include "partials/loading-indicator.njk" %}</span>
								<span id="totalVolumeSuffix" class="text-base font-light align-middle">&nbsp;</span>
							</p>
							<h3 class="text-sm whitespace-nowrap dark:text-primary-100">Trade Volume</h3>
						</li>
						<li>
							<p class="text-2xl md:text-3xl font-bold whitespace-nowrap">124</p>
							<h3 class="text-sm whitespace-nowrap dark:text-primary-100">Trading pairs</h3>
						</li>
						<li>
							<p class="text-2xl md:text-3xl font-bold whitespace-nowrap">
								<span id="apr" class="text-primary-500">{% include "partials/loading-indicator.njk" %}</span>
								<span class="text-base font-light align-middle">%</span></p>
							<h3 class="text-sm whitespace-nowrap dark:text-primary-100">APR</h3>
						</li>
					</ul>
				</div>
			</section>
		</div>

		<div class="relative pt-16">
			{# USPs DefiPlaza - Right #}
			<section class="relative xl:container xl:mx-auto flex flex-col">
				<div id="defiplaza-pool" class="md:w-1/2 ml-auto z-10 bg-white dark:bg-primary-800 md:rounded-tl-3xl md:rounded-bl-3xl pt-11 pb-24 md:pt-24 px-4 md:px-20 overflow-hidden">
					<h2 class="fluid-40 dark:text-primary-100">
						The <strong class="font-bold text-primary-500 dark:text-white">DefiPlaza pool</strong></h2>
					<p class="mt-4">The DefiPlaza pool is a 16-token pool of blue chip tokens and is 15 times more capital efficient than traditional pair-based DEXs, offering up to 15 times more fees per unit of liquidity at the same trading volume.</p>
					
					<div class="mt-16 gs_reveal gs_reveal_fromRight">
						<h3 class="fluid-30 font-bold text-primary-500 dark:text-white">Invest in a basket of 16 tokens</h3>
						<p class="fluid-30 font-light dark:text-primary-100">like an ETF fund.</p>
					</div>

					<!--<div class="mt-16 gs_reveal gs_reveal_fromRight">
						<h3 class="fluid-30 font-bold text-primary-500 dark:text-white">Swap 65% cheaper</h3>
						<p class="fluid-30 font-light dark:text-primary-100">than any other DEX.</p>
					</div>-->

					<div class="mt-16 gs_reveal gs_reveal_fromRight">
						<h3 class="fluid-30 font-bold text-primary-500 dark:text-white">Stake your liquidity tokens</h3>
						<p class="fluid-30 font-light dark:text-primary-100">and receive a <span id="aprUSP"></span> APR.</p>
					</div>
				</div>

				{# USPs StablePlaza - Left #}
				<div id="stableplaza-pool" class="md:w-1/2 z-10 bg-white dark:bg-primary-800 md:rounded-tr-3xl md:rounded-br-3xl pt-11 pb-24 md:pt-24 px-4 md:px-20 mt-16 overflow-hidden">
					<h2 class="fluid-40 dark:text-primary-100">
						The <strong class="font-bold text-primary-500 dark:text-white">StablePlaza pool</strong></h2>
					<p class="mt-4">The StablePlaza pool is a 4-token pool of stable tokens and takes the same highly optimized approach as the DefiPlaza pool to provide cheaper trades, 
						with an even lower transaction fee of 0.03% of the value traded. Thanks to the stablecoins, Impermanent Loss is minimized.</p>

					<!--<div class="mt-16 gs_reveal gs_reveal_fromLeft">
						<h3 class="fluid-30 font-bold text-primary-500 dark:text-white">Swap 30% cheaper</h3>
						<p class="fluid-30 font-light dark:text-primary-100">than any other stable token DEX.</p>
					</div>-->

					<div class="mt-16 gs_reveal gs_reveal_fromLeft">
						<h3 class="fluid-30 font-bold text-primary-500 dark:text-white">Add highly concentrated liquidity</h3>
						<p class="fluid-30 font-light dark:text-primary-100">with minimal Impermanent Loss.</p>
					</div>

					<div class="mt-16 gs_reveal gs_reveal_fromLeft">
						<h3 class="fluid-30 font-bold text-primary-500 dark:text-white">Stake your DFP2</h3>
						<p class="fluid-30 font-light dark:text-primary-100">and receive 33% of the fees.</p>
					</div>
				</div>
			</section>
		</div>
	</div>

	<div class="relative bg-primary-700 w-screen md:-mt-12 overflow-hidden">
		<div class="oval-gradient -top-80 -right-80"></div>
		<div class="oval-gradient -bottom-80 -left-80"></div>

		{# Support #}
		<section class="xl:container mx-4 xl:mx-auto flex flex-col py-20 mt-20">

			<h2 class="relative md:hidden text-center fluid-40 text-white">Learn how to<br>use <strong>DefiPlaza</strong></h2>

			<div class="flex items-center mt-6 md:mt-0 pb-10">
				<div class="hidden md:block px-3">
					<h2 class="mr-32 fluid-40 text-white w-max">Learn how to<br>use <strong>DefiPlaza</strong></h2>
				</div>

				<div class="flex items-stretch snap-x snap-mandatory overflow-x-auto ml-4 md:ml-0 pb-4 md:py-8 scrollable">
					<div class="flex flex-nowrap">
						{% for section in helpsections %}
							<div class="z-10 snap-start flex flex-col justify-between h-full w-[70vw] md:w-[150rem] py-8 md:py-16 mx-4 px-8 max-w-xs overflow-hidden rounded-lg shadow-md bg-white dark:bg-primary-800 hover:shadow-xl transition-shadow duration-300 ease-in-out">
								<h3 class="fluid-30 font-bold text-primary-500 dark:text-primary-100"><a href="/help/{{ section.slug }}/">{{ section.name }}</a></h3>
								<p class="mt-4 text-lg">{{ section.description }}</p>
								<a href="/help/{{ section.slug }}/" class="mt-16 btn-primary rounded-full w-min">
									{% include "partials/arrow-right.njk" %}
								</a>
							</div>
						{% endfor %}
					</div>
				</div>
			</div>

			{# Support pillar animation #}
			<div class="xl:container mx-4 xl:mx-auto flex flex-wrap items-center mt-0 md:mt-0 text-white" id="supportSection">
				<div class="w-full md:w-1/2 aspect-video pillar-sequence" id="pillarSequence">&nbsp;</div>
				<div class="w-full md:w-auto mt-0 pl-auto md:pl-10 lg:pl-32">
					<h3 class="text-2xl">Are you feeling lost?</h3>
					<p class="mt-2">Make sure to check out our support section.</p>
					<div class="flex">
						<a href="/help/" class="btn-white rounded-full mt-4">
							<span class="mt-px whitespace-nowrap">Get Support</span>
							{% include "partials/arrow-right.njk" %}
						</a>
					</div>
				</div>
			</div>
		</section>

		{# Roadmap #}
		<section class="relative xl:container xl:mx-auto mt-20" id="roadmap">
			<h2 class="fluid-40 mx-4 text-white text-center"><strong>Our roadmap,</strong><br class="block md:hidden"> this is what keeps us busy</h2>

			<div class="flex snap-x snap-mandatory overflow-x-scroll mt-10 pb-10 md:scrollable" id="roadmap">
				<div class="relative flex flex-wrap md:flex-nowrap items-stretch" id="roadmapItems">

					{% for roadmap in roadmaps %}
						{% if loop.index0 % 4 == 0 %}
							{% set margin = 'md:mt-8' %}
						{% elif loop.index0 % 4 == 1 or loop.index0 % 4 == 3 %}
							{% set margin = 'md:mt-80' %}
						{% elif loop.index0 % 4 == 2 %}
							{% set margin = 'md:mt-32' %}
						{% endif %}

						<div class="relative snap-start md:w-40 overflow-x-visible border-primary-300 mx-4 md:mx-0 md:pb-8 bg-repeat-y" style="background-position: 7px 0px; background-image: url('/assets/images/home/lines.svg'">
							{% if loop.index0 == 0 %}
								<p class="md:absolute md:top-1/3 md:-transform-y-1/2 md:left-16 md:text-9xl text-4xl ml-6 md:ml-0 font-light text-primary-500 z-0">Past</p>
							{% elif loop.index0 % 4 == 3 %}
								<p class="md:absolute md:top-1/3 md:-transform-y-1/2 md:left-16 md:text-9xl text-4xl ml-6 md:ml-0 mt-6 md:mt-0 font-light text-primary-500 z-0">Future</p>
							{% endif %}

							<div class="relative z-10 bg-white dark:bg-primary-800 rounded-lg md:w-80 min-h-40 mt-4 {{ margin }} ml-8 p-6 pr-8">
								<div class="absolute top-5 -left-8 rounded-full w-4 h-4 bg-white dark:bg-primary-100"></div>

								{% if loop.index0 % 4 == 2 %}
									<div class="hidden md:block absolute w-0.5 h-16 bg-white dark:bg-primary-100 -top-16 left-[100px]"></div>
									<div class="hidden md:block absolute w-0.5 h-24 bg-white dark:bg-primary-100 -bottom-24 left-[100px]"></div>
								{% endif %}

								<h3 class="text-lg text-primary-500 dark:text-white">
									<strong class="dark:text-primary-100">{{ roadmap.acf.roadmap_item_date }}</strong>
									{{ roadmap.title.rendered | safe }}</h3>
								<p class="text-xs mt-4">{{ roadmap.excerpt.rendered | striptags }}</p>
							</div>
						</div>

						{% if loop.index0 % 2 == 1 or loop.index0 % 4 == 2 %}
							<div class="hidden md:block w-40 h-full overflow-x-visible ml-4 pb-8 bg-repeat-y" style="background-position: 7px 0px; background-image: url('/assets/images/home/lines.svg'">&nbsp;</div>
						{% endif %}

					{% endfor %}
				</div>
			</div>
		</section>

		{# Latest Updates #}
		<section class="relative xl:container mx-4 xl:mx-auto mt-20 lg:mt-40">
			<div class="flex justify-center space-x-8">
				<h2 class="fluid-40 text-white text-center"><a href="/update/">Latest news from <strong>DefiPlaza</strong></a></h2>
				<a href="/update/" class="btn-primary bg-primary-300 dark:bg-white rounded-full hidden md:inline-flex items-center">
					<span class="mt-px whitespace-nowrap">All updates</span>
					{% include "partials/arrow-right.njk" %}
				</a>
			</div>
			<ul class="md:max-w-[65ch] md:mx-auto mt-10 px-4 md:px-8 bg-white dark:bg-primary-800 rounded-lg divide-y divide-background-700 dark:divide-primary-500">
				{% for post in latest_updates %}
					<li class="py-8">
						<h3 class="text-primary-500 dark:text-white font-bold text-2xl">
							<a href="/update/{{ post.slug }}/" class="hover:underline">{{ post.title.rendered | safe }}</a>
						</h3>
						<p class="text-primary-500 dark:text-primary-100 text-xs mt-2">{{ post._embedded.author[0].name }} - {{ post.date | wpDateToString }}</p>
						<div class="mt-2 line-clamp-3">{{ post.content.rendered | striptags }}</div>
					</li>
				{% endfor %}
			</ul>
		</section>

		{% include "partials/footer.njk" %}
	</div>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/ScrollTrigger.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bignumber.js/8.0.2/bignumber.min.js" integrity="sha512-7UzDjRNKHpQnkh1Wf1l6i/OPINS9P2DDzTwQNX79JxfbInCXGpgI1RPb3ZD+uTP3O5X7Ke4e0+cxt2TxV7n0qQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

	<script>
		document.addEventListener("DOMContentLoaded", function () {

			gsap.registerPlugin(ScrollTrigger);

			ScrollTrigger.matchMedia({
				// desktop
				"(min-width: 800px)": function () {
					// Pin stats
					gsap.timeline({
						scrollTrigger: {
							trigger: "#heroSection",
							pin: "#stats",
							start: "top top+=73px",
							end: "bottom bottom-=16px", //+=50px //function() { return "+=" + (gsap.getProperty("#heroSection", "height") - gsap.getProperty("#stats", "height")) },
						}
					})
				}
			});

			// Load Hercules sequence
			document.getElementById('heroSequence').classList.add('hero-sequence');

			// Hercules looking up
			//var frame_count = 22; // number of frames - 2 (normal -1 because then last frame is in view, but Chrome is acting weird)

			const rows = 6;
			const columns = 4;
			const missingImages = 1; // The number of missing images in the last column
			const frame_count = rows * columns - missingImages - 1;

			function calcSizes(id, imageWidth, imageHeight) {
				let aspectRatio = imageWidth/imageHeight;
			
				let boxHeight = document.getElementById(id).offsetHeight; //imageHeight / rows;
				let boxWidth = aspectRatio * boxHeight; //imageWidth / columns;

				let bgHeight = document.getElementById(id).offsetHeight * rows;
				let bgWidth = (boxHeight/imageHeight) * imageWidth * columns;

				gsap.set('#' + id, {width: boxWidth, height: boxHeight});
				document.getElementById(id).style.backgroundSize = `${bgWidth}px ${bgHeight}px`;

				return { boxHeight, boxWidth };
			}
			
			heroSizes = calcSizes('heroSequence', 465, 829);
			pillarSizes = calcSizes('pillarSequence', 1920, 1080);

			const setPos = gsap.quickSetter("#heroSequence", "background-position");

			const heroObj = {num: 0};
			gsap.to(heroObj, {
				num: frame_count,
				ease: "steps(" + frame_count + ")",
				scrollTrigger: {
					trigger: "#heroSection",
					start: "top top",
					end: () => innerHeight * 0.5, //"+=" + (frame_count * 0.9 * offset_value),
					pin: false,
					scrub: true,
					markers: false,
					invalidateOnRefresh: true
				},
				onUpdate: () => setPos(`${-Math.round((heroObj.num % columns) * heroSizes.boxWidth)}px ${-Math.round(Math.floor(heroObj.num / columns) * heroSizes.boxHeight)}px`)
			});

			const setPosPillar = gsap.quickSetter("#pillarSequence", "background-position");

			const pillarObj = {num: 0};
			gsap.to(pillarObj, {
				num: frame_count,
				ease: "steps(" + frame_count + ")",
				scrollTrigger: {
					trigger: "#supportSection",
					start: "top 75%",
					end: "center center",
					pin: false,
					scrub: true,
					markers: false,
					invalidateOnRefresh: true
				},
				onUpdate: () => {
					setPosPillar(`${-Math.round((pillarObj.num % columns) * pillarSizes.boxWidth)}px ${-Math.round(Math.floor(pillarObj.num / columns) * pillarSizes.boxHeight)}px`)
				}
			});

			// USPs
			function animateFrom(elem, direction) {
				direction = direction || 1;

				var startX,
					endX = 0,
					startY,
					endY = 0,
					startAlpha = 0,
					endAlpha = 1;

				if (elem.classList.contains("gs_reveal_fromLeft")) {
					startX = -100;
					startY = 0;
				} else if (elem.classList.contains("gs_reveal_fromRight")) {
					startX = 100;
					startY = 0;
				}

				if (direction == -1) {
					startAlpha = 1;
					endAlpha = 0;

					endX = startX;
					startX = 0

					endY = startY;
					startY = 0;
				}

				gsap.fromTo(elem, {
					x: startX,
					y: startY,
					autoAlpha: startAlpha
				}, {
					duration: 1.25,
					x: endX,
					y: endY,
					autoAlpha: endAlpha,
					ease: "expo",
					overwrite: "auto"
				});
			}

			function hide(elem) {
				gsap.set(elem, {autoAlpha: 0});
			}

			var reveals = gsap.utils.toArray(".gs_reveal");

			for (var i = 0; i < reveals.length; i++) {
				(function () {
					var elem = reveals[i];
					hide(elem); // make sure that the element is hidden when scrolled into view

					ScrollTrigger.create({
						trigger: elem,
						start: "top 90%",
						onEnter: function () {
							animateFrom(elem)
						},
						onLeaveBack: function () {
							animateFrom(elem, -1)
						}
					});
				})();
			}
		});
	</script>

	{# Fetch stats from TheGraph #}
	<script type="text/javascript">
		document.addEventListener("DOMContentLoaded", function () {
			const queryBody = JSON.stringify({query: `{
				factories(first: 1) {
					totalValueLockedUSD
					totalTradeVolumeUSD
					xdp2TotalSupply
					xdp2Staked
				}
				
					token(id: "0x2f57430a6ceda85a67121757785877b4a71b8e6d") {
						tokenAmount
					} 
			}`});

			fetch('https://api.thegraph.com/subgraphs/name/omegasyndicate/defiplaza', {
				method: 'post',
				headers: {
					'Content-Type': 'application/json'
				},
				body: queryBody
			})
				.then(function (result) {
					return result.json()
				})
				.then(function (jsonResult) {
					return jsonResult.data;
				})
				.then(function (graphData) {
					function prettyValue(value) {
						var size = "M";
						var prettyValue;
						var sign = value < 0 ? '-' : '';
						var value = Math.abs(value);
								
						if(value < 1) {
							prettyValue = parseFloat(value).toFixed(3);
							size = ""
						} else if(value < 1000) {
							prettyValue = parseFloat(value).toFixed(2);
							size = ""
						} else if(value < 10000) {
							prettyValue = Math.round(value);
							size = ""
						} else if(value < 100000) {
							prettyValue = parseFloat(value/1000).toFixed(1);
							size = "K"
						} else if(value < 1000000) {
							prettyValue = Math.round(value/1000);
							size = "K"
						} else  if(value < 10000000) { // 10M
							prettyValue = parseFloat(value/1000000).toFixed(2);
						} else {
							prettyValue = parseFloat(value/1000000).toFixed(1);
						}

						return {
							value: prettyValue,
							size: size
						}
					}

					// TVL
					const prettyTVL = prettyValue(graphData.factories[0].totalValueLockedUSD);
					const tvlEl = document.getElementById("tvl");
					tvlEl.innerText = "$" + prettyTVL.value.toLocaleString();
					tvlEl.classList.remove('text-primary-500');
					document.getElementById("tvlSuffix").innerText = prettyTVL.size;

					// Trade Volume
					const prettyVolume = prettyValue(graphData.factories[0].totalTradeVolumeUSD);
					const volumeEl = document.getElementById("totalVolume");
					volumeEl.innerText = "$" + prettyVolume.value.toLocaleString();
					volumeEl.classList.remove('text-primary-500');
					document.getElementById("totalVolumeSuffix").innerText = prettyVolume.size;

					// APR
					const decimals = 2;
					const ten = BigNumber(10);
					const multiplier = Math.pow(10, decimals + 2);
					const divider = Math.pow(10, decimals);
					const startTime = 1633514400;
					const tsNow = Math.ceil(+ new Date() / 1000);
					const oneYear = 31536000;

					const xdp2TotalSupply = BigNumber(graphData.factories[0].xdp2TotalSupply).times(ten.pow(18));
					const xdp2Staked = BigNumber(graphData.factories[0].xdp2Staked).times(ten.pow(18));
					const dfp2TokenAmount = BigNumber(graphData.token.tokenAmount).times(ten.pow(18));

					const c1 = BigNumber(100).times(ten.pow(24));
					const c2 = BigNumber(50).times(ten.pow(24));
					const c3 = BigNumber(994519296000000);

					const t1 = BigNumber(Math.min(Math.max(tsNow - startTime, 0), oneYear));
					const dR = c1
						.div(oneYear)
						.minus(c2.div(c3).times(2).times(t1));

					const aprPermyriad = xdp2TotalSupply
						.times(dR)
						.times(oneYear)
						.times(multiplier)
						.div(dfp2TokenAmount.times(16))
						.div(xdp2Staked);

					const apr = Math.round(aprPermyriad.toNumber() / divider);

					const aprEl = document.getElementById("apr");
					aprEl.innerText = apr;
					aprEl.classList.remove('text-primary-500');

					document.getElementById("aprUSP").innerText = apr + '%';
				});
		});
	</script>
{% endblock %}